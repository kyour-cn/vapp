"use strict";var App={name:"",el:"#v-page",host:"",href:"",local:"",res:"",back_history:[],temp:{},$res:{css:[],js:[]},isApp:!1,route:[],view:null,ajax:function(t,e){if(t.url="base"in t?t.base+t.url:this.href+t.url,this.isApp){var n=t.data;t.data={values:n},api.ajax(t,e)}else{var i={url:t.url,method:t.method?t.method:"get",timeout:t.timeout?t.timeout:5e3};if(t.data)if("get"===i.method)i.params=t.data;else{i.data=new FormData;for(var o in t.data)i.data.append(o,t.data[o])}axios.request(i).then(function(t){e(t.data,null)}).catch(function(t){e(null,t)})}},load:function(t,e,n){var i=this;this.isApp?api.ajax({url:e,dataType:"text",method:"get"},function(e,o){e&&i.html(t,e),n&&n(e,o)}):axios.get(e).then(function(e){i.html(t,e.data),n&&n(ret,null)}).catch(function(t){n&&n(null,t)})},getTemplateAttr:function(t,e){var n="<"+e+">",i="</"+e+">";return""===t||t.indexOf(n)<0||t.indexOf(i)<0?"":t.substring(t.indexOf(n)+n.length,t.lastIndexOf(i))},html:function(t,e){t=this.dom(t),t.innerHTML=this.getTemplateAttr(e,"template");var n=this.getTemplateAttr(e,"script");n&&"execScript"in window?window.execScript(n):n&&window.eval(n)},loadRes:function(t,e,n){var i=void 0;if("js"===e)i=document.createElement("script"),i.setAttribute("type","text/javascript"),i.setAttribute("src",t);else{if("css"!==e)return;i=document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t)}void 0!==i&&document.getElementsByTagName("head")[0].appendChild(i),this.$res[e].push(t),n&&n()},remRes:function(t,e){for(var n="js"===e?"script":"css"===e?"link":"none",i="js"===e?"src":"css"===e?"href":"none",o=document.getElementsByTagName(n),r=o.length;r>=0;r--)o[r]&&null!==o[r].getAttribute(i)&&-1!==o[r].getAttribute(i).indexOf(t)&&o[r].parentNode.removeChild(o[r])},remAllRes:function(){for(var t in this.$res.css)this.remRes(this.$res.css[t],"css"),delete this.$res.css[t]},setTitle:function(t){window.document.title=t},use:function(t,e){for(var n in t)Vue.use(e[t[n]])},open:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];page&&page.$destroy&&page.$destroy(),e&&(window.location.href="#"+t,this.route.push(t));var n=this.formatRoute(t).url;this.load("#v-page",n,function(t,e){App.view.overlay=!1})},toBack:function(){if(this.route.length<=1)return window.location.href="/",console.warn("No previous page");this.route.pop();var t=this.route.pop();this.open(t)},addBack:function(t){App.back_history.push(t)},goBack:function(t){var e=App.back_history.pop();return!0===t||(-1===t?(App.back_history=[],!0):!!e&&(e(),!0))},redirect:function(t){this.route[this.route.length-1]=t,window.location.href="#"+t},formatRoute:function(t){var e=t.indexOf("#")+1,n=t.indexOf("-");return-1===n&&(n=t.length),{url:t.substr(e,n),param:t.substr(n+1)}},getRoute:function(){return this.route[this.route.length-1]},getCookie:function(t){for(var e=document.cookie.split("; "),n=0;n<e.length;n++){var i=e[n].split("=");if(i[0]==t)return i[1]}return""},dom:function(t){return document.querySelector(t)},openApp:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"open",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"xoshe",n=document.createElement("iframe");n.style.cssText="display:none;width=0;height=0",document.body.appendChild(n),n.src=e+"://"+t,setTimeout(function(){window.location.href="/download"},500)},getYmd:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return e=new Date(1e3*parseInt(t)),n=e.getFullYear()+i,n+=("0"+(e.getMonth()+1)).slice(-2)+i,n+=("0"+e.getDate()).slice(-2)},openWin:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"appwin",e=arguments[1];e.root||(e.root="html/app/appwin.html"),this.isApp?api.openWin({name:t,url:"widget://"+e.root,pageParam:e}):(vant.Dialog.confirm({title:"抱歉",message:"该功能在浏览器中不可用，是否启动App？"}).then(function(){App.openApp()}).catch(function(){}))}};